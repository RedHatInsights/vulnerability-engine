FROM fedora:28
ENV VMAAS_VERSION=latest

RUN dnf -y update \
        && dnf -y install python3-tornado \
        && rm -rf /var/cache/dnf/*

ADD entrypoint.sh /mock/
ADD *.py /mock/
ADD data /mock/data
ADD data/users /mock/data/users
ADD data/inventory /mock/data/inventory

RUN adduser --gid 0 -d /mock --no-create-home -c 'Red Hat Insights' insights
USER insights

EXPOSE 8080

CMD ["/mock/entrypoint.sh"]
