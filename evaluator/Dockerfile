FROM fedora:28

RUN dnf -y update \
        && dnf -y install python3-kafka python3-requests \
        && rm -rf /var/cache/dnf/*

ENV APPBASEDIR=/evaluator

ADD entrypoint.sh $APPBASEDIR/
ADD *.py $APPBASEDIR/

RUN adduser --gid 0 -d $APPBASEDIR --no-create-home -c 'Red Hat Insights' insights
USER insights

CMD ["sh", "-c", "$APPBASEDIR/entrypoint.sh"]
