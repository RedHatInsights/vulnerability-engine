import os
import logging
import datetime
from kafka import KafkaConsumer

BOOTSTRAP_SERVERS = 'kafka:9092'
GROUP_ID = 'vulnerability' # The group ID for this service broker
ENGINE_RESULTS_TOPIC = 'vulnerability_results'  # the topic to subscribe to for engine results

logging.basicConfig(level=logging.INFO)
logging.info("Using BOOTSTRAP_SERVERS: %s" % BOOTSTRAP_SERVERS)
logging.info("Using GROUP_ID: %s" % GROUP_ID)
logging.info("Using ENGINE_RESULTS_TOPIC: %s" % ENGINE_RESULTS_TOPIC)

c = KafkaConsumer(ENGINE_RESULTS_TOPIC,
                  bootstrap_servers=BOOTSTRAP_SERVERS,
                  group_id=GROUP_ID,
                  auto_offset_reset='earliest',
    )


for msg in c:
    logging.info('Received Platform Kafka message at %s from topic %s: %s',
                 datetime.datetime.now(), msg.topic, msg.value)


