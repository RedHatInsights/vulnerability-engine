openapi: "3.0.0"

info:
  title: Vulnerability Engine Manager

paths:
  /v1/version:
    get:
      summary: Application version
      description: Get application version.
      operationId: manager.version_handler.GetVersion.get
      x-methodName: getVersion
      responses:
        200:
          description: Application version.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/VersionOut'

  /v1/cves/{cve_id}:
    get:
      summary: Details of a CVE.
      description: Show all information about given CVE.
      operationId: manager.cve_handler.GetCves.get
      x-methodName: getCveDetails
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: CVE details
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/CveDetailOut'
        404:
          description: Given CVE does not exist.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters:
        - $ref: '#/components/parameters/cve_id'

  /v1/cves/{cve_id}/affected_systems:
    get:
      summary: Affected systems for a given CVE.
      description: Report of affected systems for a given CVE.
      operationId: manager.cve_handler.GetCvesAffectedSystems.get
      x-methodName: getAffectedSystemsByCve
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: Report of affected systems for a given CVE.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/AffectedSystemsOut'
        404:
          description: Given CVE does not exist.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters:
        - $ref: '#/components/parameters/filter'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/page_size'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/cve_id'
        - $ref: '#/components/parameters/status_id'
        - $ref: '#/components/parameters/data_format'

  /v1/status:
    get:
      summary: Available status/status_id pairs.
      description: Returns available status and status_id pairs where status_id is internal ID of the status.
      operationId: manager.status_handler.GetStatus.get
      x-methodName: getStatusList
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: List of status/status_id pairs.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/StatusListOut'
    patch:
      summary: Set status for system vulnerability.
      description: Sets status for given host and CVE.
      operationId: manager.status_handler.PatchStatus.patch
      x-methodName: setStatus
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      requestBody:
        description: Values to be set.
        required: true
        content:
          application/vnd.api+json:
            schema:
              $ref: '#/components/schemas/StatusIn'
              x-body-name: data
      responses:
        200:
          description: Status sucessfully updated.
        404:
          description: Given host/CVE does not exist.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'

  /v1/systems:
    get:
      summary: List systems.
      description: List systems visible to logged in account with basic information related to vulnerabilities.
      operationId: manager.system_handler.GetSystems.get
      x-methodName: getSystemsList
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: System list
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/SystemListOut'
      parameters:
        - $ref: '#/components/parameters/filter'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/page_size'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/data_format'
        - in: query
          name: opt_out
          description: If set to true, shows systems which have been opted out from vulnerability application. If not set defaults to false.
          schema:
            type: boolean
          example: true

  /v1/systems/{inventory_id}/cves:
    get:
      summary: CVE report for a system.
      description: Shows detailed infomation about all CVEs the system is exposed to.
      operationId: manager.system_handler.GetSystemsCves.get
      x-methodName: getCveListBySystem
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: CVE report.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/SystemCvesOut'
        404:
          description: System has not been found in the database.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters:
        - $ref: '#/components/parameters/inventory_id'
        - $ref: '#/components/parameters/filter'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/page_size'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/cvss_from'
        - $ref: '#/components/parameters/cvss_to'
        - $ref: '#/components/parameters/public_from'
        - $ref: '#/components/parameters/public_to'
        - $ref: '#/components/parameters/severity'
        - $ref: '#/components/parameters/status_id'
        - $ref: '#/components/parameters/data_format'

  /v1/systems/{inventory_id}/opt_out:
    patch:
      summary: Opt in/out a system to/from vulnerability application.
      description: Opts in/out a systems. Opted out system is not shown and manageable by the vulnerability application.
      operationId: manager.system_handler.PatchSystemsOptOut.patch
      x-methodName: setSystemOptOut
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: System setting has been updated.
        404:
          description: System has not been found in the database.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters: 
        - $ref: '#/components/parameters/inventory_id'
        - in: query
          name: value
          description: opt_out setting of the host.
          required: true
          schema:
            type: boolean
            example: true

  /v1/vulnerabilities/cves:
    get:
      summary: Vulnerabilities overview.
      description: Overview of vulnerabilities across whole host inventory.
      operationId: manager.vulnerabilities_handler.GetCves.get
      x-methodName: getCveList
      security:
        - ApiKeyAuth: []
        - BasicAuth: []
      responses:
        200:
          description: Vulnerabilities overview.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/VulnerabilitiesOut'
      parameters:
        - $ref: '#/components/parameters/filter'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/offset'
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/page_size'
        - $ref: '#/components/parameters/sort'
        - $ref: '#/components/parameters/cvss_from'
        - $ref: '#/components/parameters/cvss_to'
        - $ref: '#/components/parameters/public_from'
        - $ref: '#/components/parameters/public_to'
        - $ref: '#/components/parameters/severity'
        - $ref: '#/components/parameters/data_format'
        - in: query
          name: show_all
          description: Show all known vulnerabilities, regardless of number of affected systems.
          schema:
            type: boolean
          example: true

  /v1/refresh/accounts/{account_id}:
    put:
      summary: Refresh cached counts for given account ID.
      description: Refresh cached counts for given account ID. Admin interface, available only to internal users.
      operationId: manager.refresh_handler.RefreshAccount.put
      x-methodName: refreshAccount
      security:
        - ApiKeyAuthInternal: []
        - BasicAuth: []
      responses:
        200:
          description: Cached counts for given account sucessfully updated.
        404:
          description: Account was not found.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters: 
        - $ref: '#/components/parameters/account_id'
      tags:
        - internal

  /v1/refresh/accounts/{account_id}/cves/{cve_id}:
    put:
      summary: Refresh cached counts for given account ID and CVE.
      description: Refresh cached counts for given account ID and CVE. Admin interface, available only to internal users.
      operationId: manager.refresh_handler.RefreshAccountCve.put
      x-methodName: refreshAccountCve
      security:
        - ApiKeyAuthInternal: []
        - BasicAuth: []
      responses:
        200:
          description: Cached counts for given account and CVE sucessfully updated.
        404:
          description: Account or CVE was not found.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters: 
        - $ref: '#/components/parameters/account_id'
        - $ref: '#/components/parameters/cve_id'
      tags:
        - internal

  /v1/refresh/cves/{cve_id}:
    put:
      summary: Refresh cached counts for given CVE.
      description: Refresh cached counts for given CVE. Admin interface, available only to internal users.
      operationId: manager.refresh_handler.RefreshCve.put
      x-methodName: refreshCve
      security:
        - ApiKeyAuthInternal: []
        - BasicAuth: []
      responses:
        200:
          description: Cached counts for given CVE sucessfully updated.
        404:
          description: CVE was not found.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters: 
        - $ref: '#/components/parameters/cve_id'
      tags:
        - internal

  /v1/refresh/systems/{inventory_id}:
    put:
      summary: Refresh cached counts for given inventory ID.
      description: Refresh cached counts for given inventory ID. Admin interface, available only to internal users.
      operationId: manager.refresh_handler.RefreshSystem.put
      x-methodName: refreshSystem
      security:
        - ApiKeyAuthInternal: []
        - BasicAuth: []
      responses:
        200:
          description: Cached counts for given system sucessfully updated.
        404:
          description: System was not found.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
        503:
          description: Service is running in read-only mode.
          content:
            application/vnd.api+json:
              schema:
                $ref: '#/components/schemas/Errors'
      parameters: 
        - $ref: '#/components/parameters/inventory_id'
      tags:
        - internal

components:
  parameters:
    filter:
      in: query
      name: filter
      description: Full text filter.
      schema:
        type: string
      example: INV-ID-1234

    limit:
      in: query
      name: limit
      description: Maximum number of records per page. Limit/Offset pagination wins over page/page_size pagination.
      schema:
        type: integer
      example: 25

    offset:
      in: query
      name: offset
      description: Offset of first record of paginated response. Limit/Offset pagination wins over page/page_size pagination.
      schema:
        type: integer
      example: 1

    page:
      in: query
      name: page
      description: Page number of paginated response. Limit/Offset pagination wins over page/page_size pagination.
      schema:
        type: integer
      example: 1
  
    page_size:
      in: query
      name: page_size
      description: Page size of paginated response. Limit/Offset pagination wins over page/page_size pagination.
      schema:
        type: integer
      example: 25

    sort:
      in: query
      name: sort
      description: Sorting used for response.
      schema:
        type: string
      example: -inventory_id

    inventory_id:
      in: path
      name: inventory_id
      description: Inventory ID of the host to be opted in/out.
      required: true
      schema:
        type: string
      example: INV-ID-0000-1234

    cve_id:
      in: path
      name: cve_id
      description: CVE id.
      required: true
      schema:
        type: string
      example: CVE-2016-0800

    public_from:
      in: query
      name: public_from
      description: Filter CVEs based on their published date, starting from the date.
      schema:
        type: string
      example: '2017-09-18T00:00:00+00:00'

    public_to:
      in: query
      name: public_to
      description: Filter CVEs based on their published date, up to the date.
      schema:
        type: string
      example: '2017-09-18T00:00:00+00:00'

    cvss_from:
      in: query
      name: cvss_from
      description: Filter based on cvss score, starting from the value.
      schema:
        type: number
      example: 4.6

    cvss_to:
      in: query
      name: cvss_to
      description: Filter based on cvss score, up to the value.
      schema:
        type: number
      example: 7.2

    severity:
      in: query
      name: severity
      description: Filter based on severity IDs.
      schema:
        type: string
      example: '5,7'

    status_id:
      in: query
      name: status_id
      description: Filer based on CVE status ID.
      schema:
        type: string
        example: '1,4'

    data_format:
      in: query
      name: data_format
      description: Format of the output data, either JSON (defualt) or CSV.
      schema:
        type: string
        example: json

    account_id:
      in: path
      name: account_id
      description: Account ID of user.
      required: true
      schema:
        type: string
      example: '123456'

  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
      description: Username and password login.
      x-basicInfoFunc: manager.base.basic_auth

    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-rh-identity
      description: Identity header provided by 3scale (for non-prod testing only).
      x-apikeyInfoFunc: manager.base.auth
    
    ApiKeyAuthInternal:
      type: apiKey
      in: header
      name: x-rh-identity
      description: Identity header provided by 3scale (for non-prod testing only).
      x-apikeyInfoFunc: manager.base.auth_internal

  schemas:
    Errors:
      type: object
      properties:
        errors:
          type: array
          items:
            type: object
            properties:
              detail:
                type: string
                description: Error detail.
                example: Record not found.
              status:
                type: string
                description: String representation of HTTP status code.
                example: 404
            required:
              - detail
              - status
          minItems: 1
      required:
        - errors

    Links:
      type: object
      properties:
        first:
          type: string
          description: Link to first page.
          example: /api?offset=0&limit=1
        last:
          type: string
          description: Link to last page.
          example: /api?offset=7&limit=1
        next:
          type: string
          description: Link to next page.
          example: /api?offset=5&limit=1
          nullable: true
        previous:
          type: string
          description: Link to next page.
          example: /api?offset=3&limit=1
          nullable: true
      required:
        - first
        - last
        - next
        - previous

    Meta:
      type: object
      properties:
        filter:
          type: string
          description: Full text filter
          example: CVE-2016-0800
          nullable: true
        limit:
          type: integer
          description: Maximum number of paginated results.
          example: 25
        offset:
          type: integer
          description: First record of paginated response.
          example: 0
        page:
          type: integer
          description: Page number of paginated response.
          example: 1
        page_size:
          type: integer
          description: Number of records per page of paginated response.
          example: 25
        pages:
          type: integer
          description: Total number of pages of paginated response.
          example: 1
        sort:
          type: string
          description: Sorting filter.
          example: -inventory_id
          nullable: true
        total_items:
          type: integer
          description: Total number of records.
          example: 37
      required:
        - filter
        - limit
        - offset
        - page
        - page_size
        - pages
        - sort
        - total_items

    MetaAffectedSystems:
      allOf:
        - $ref: '#/components/schemas/Meta'
        - type: object
          properties:
            status_id:
              type: string
              description: Filer based on CVE status ID.
              example: '1,4'
              nullable: true
          required:
            - status_id

    MetaSystems:
      allOf:
        - $ref: '#/components/schemas/Meta'
        - type: object
          properties:
            opt_out:
              type: boolean
              description: Whether the filter to show opted out systems is active or not. If not set, defaults to hiding opted out systems.
              example: false
              nullable: true
          required:
            - opt_out

    MetaCves:
      allOf:
        - $ref: '#/components/schemas/Meta'
        - type: object
          properties:
            cvss_from:
              type: number
              description: Filter based on cvss score, starting from the value.
              example: 4.6
              nullable: true
            cvss_to:
              type: number
              description: Filter based on cvss score, up to the value.
              example: 7.2
              nullable: true
            public_from:
              type: string
              description: Filter CVEs based on their published date, starting from the date.
              example: '2017-09-18T00:00:00+00:00'
              nullable: true
            public_to:
              type: string
              description: Filter CVEs based on their published date, up to the date.
              example: '2017-09-18T00:00:00+00:00'
              nullable: true
            severity:
              type: string
              description: Filter based on severity IDs.
              example: '5,7'
              nullable: true
            status_id:
              type: string
              description: Filer based on CVE status ID.
              example: '1,4'
              nullable: true
          required:
            - cvss_from
            - cvss_to
            - public_from
            - public_to
            - status_id


    AffectedSystemsOut:
      type: object
      properties:
        data:
          oneOf:
            - type: string
              description: CSV export of the JSON.
            - type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: Host id.
                    example: INV-ID-0000-1234
                  type:
                    type: string
                    description: Type of the record.
                    example: system
                  attributes:
                    type: object
                    properties:
                      inventory_id:
                        type: string
                        description: Host ID.
                        example: INV-ID00-0000-1234
                      last_evaluation:
                        type: string
                        description: Date of last evaluation.
                        example: '2018-09-22T16:00:00+00:00'
                      satellite_managed:
                        type: boolean
                        description: Whether the host is managed by Satellite or not.
                        example: true
                      status_id:
                        type: integer
                        description: Internal ID of the vulnerability status.
                        example: 4
                      status_name:
                        type: string
                        description: Status of the vulnerability for the application's point of view.
                        example: Resolved
                    required:
                      - inventory_id
                      - last_evaluation
                      - satellite_managed
                      - status_id
                      - status_name
                required:
                  - id
                  - type
                  - attributes
        links:
          $ref: '#/components/schemas/Links'
        meta:
          $ref: '#/components/schemas/MetaAffectedSystems'
      required:
        - data
        - links
        - meta

    CveDetailOut:
      type: object
      properties:
        data:
          type: object
          properties:
            id:
              type: string
              description: CVE id.
              example: CVE-2016-0800
            type:
              type: string
              description: Type of the record.
              example: cve
            attributes:
              type: object
              properties:
                cvss2_metrics:
                  type: string
                  description: cvss2 metrics of the CVE.
                  example: 'AV:N/AC:M/Au:N/C:P/I:P/A:N'
                cvss2_score:
                  type: string
                  description: String representation of cvss2 score of the CVE.
                  example: '5.800'
                cvss3_metrics:
                  type: string
                  description: cvss3 metrics of the CVE.
                  example: 'AV:N/AC:M/Au:N/C:P/I:P/A:N'
                cvss3_score:
                  type: string
                  description: String representation of cvss3 score of the CVE.
                  example: '4.400'
                cwe_list:
                  type: array
                  items:
                    type: string
                    description: CWE.
                    example:
                      - CWE-400
                      - CWE-401
                description:
                  type: string
                  description: Description of the CVE.
                  example: A padding oracle flaw was found in the Secure Sockets Layer version 2.0 (SSLv2) protocol. An attacker could...
                errata_list:
                  type: array
                  description: List of Red Hat erratas fixing the CVE.
                  items:
                    type: string
                    description: Name of the erratum.
                    example:
                      - RHSA-2016:0301
                      - RHSA-2016:0372
                modified_date:
                  type: string
                  description: String representation of ISO-8601 formatted date of last modification of the CVE.
                  example: '2019-03-07T08:15:36+00:00' 
                impact:
                  type: string
                  description: Red Hat security impact of the CVE.
                  example: Important
                package_list:
                  type: array
                  description: List of packages where the fix for the CVE appeared.
                  items:
                    type: string
                    description: Name of the package containing fix for the CVE.
                    example:
                      - openssl098e-0.9.8e-29.el7_2.3.i686
                      - openssl-devel-1:1.0.1e-51.el7_2.4.x86_64
                      - openssl-1:1.0.1e-51.el7_2.4.x86_64
                      - openssl-libs-1:1.0.1e-51.el7_2.4.i686
                      - openssl-devel-1:1.0.1e-51.el7_2.4.i686
                      - openssl-libs-1:1.0.1e-51.el7_2.4.x86_64
                      - openssl098e-0.9.8e-29.el7_2.3.x86_64
                public_date:
                  type: string
                  description: String representation of ISO-8601 formatted date of first public disclosure of the CVE.
                  example: '2016-03-01T00:00:00+00:00'
                redhat_url:
                  type: string
                  description: Additional resource about the CVE, provided by Red Hat.
                  example: https://access.redhat.com/security/cve/cve-2016-0800
                secondary_url:
                  type: string
                  description: Additional resources about the CVE.
                  example: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800
                synopsis:
                  type: string
                  description: Synopsis of the CVE.
                  example: CVE-2016-0800
              required:
                - cvss2_metrics
                - cvss2_score
                - cvss3_metrics
                - cvss3_score
                - cwe_list
                - description
                - errata_list
                - impact
                - modified_date
                - package_list
                - public_date
                - redhat_url
                - secondary_url
                - synopsis
          required:
            - id
            - type
            - attributes

    StatusIn:
      type: object
      properties:
        inventory_id:
          type: string
          description: Host ID.
          example: INV-ID00-0000-1234
        cve:
          type: string
          description: CVE name.
          example: CVE-2016-0800
        status_id:
          type: integer
          description: Status ID to be set, obtained by GET method.
          example: 3
      required:
        - inventory_id
        - cve
        - status_id

    StatusListOut:
      type: object
      properties:
        data:
          type: array
          description: List of available status/status_id pairs.
          items:
            type: object
            properties:
              id:
                type: integer
                description: Internal status_id.
                example: 3
              name:
                type: string
                description: Represenation of internal status_id.
                example: Scheduled for Patch
            required:
              - id
              - name
        meta:
          type: object
          properties:
            total_items:
              type: integer
              description: Total number of available status/status_id pairs.
              example: 1
          required:
            - total_items
      required:
        - data
        - meta
  
    SystemCvesOut:
      type: object
      properties:
        data:
          oneOf:
            - type: string
              description: CSV export of the JSON.
            - type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: CVE id.
                    example: CVE-2016-0800
                  type:
                    type: string
                    description: Type of the record.
                    example: cve
                  attributes:
                    type: object
                    properties:
                      cvss2_score:
                        type: string
                        description: String representation of cvss2 score of the CVE.
                        example: '5.800'
                      cvss3_score:
                        type: string
                        description: String representation of cvss3 score of the CVE.
                        example: '4.400'
                      description:
                        type: string
                        description: Description of the CVE.
                        example: A padding oracle flaw was found in the Secure Sockets Layer version 2.0 (SSLv2) protocol. An attacker could...
                      impact:
                        type: string
                        description: Red Hat security impact of the CVE.
                        example: Important
                      public_date:
                        type: string
                        description: String representation of ISO-8601 formatted date of first public disclosure of the CVE.
                        example: '2016-03-01T00:00:00+00:00'
                      status:
                        type: string
                        description: Status of the vulnerability for the application's point of view.
                        example: Resolved
                      status_id:
                        type: integer
                        description: Internal ID of the vulnerability status.
                        example: 4
                      synopsis:
                        type: string
                        description: Synopsis of the CVE.
                        example: CVE-2016-0800
                    required:
                      - cvss2_score
                      - cvss3_score
                      - description
                      - impact
                      - public_date
                      - status
                      - status_id
                      - synopsis
                required:
                  - id
                  - type
                  - attributes
        links:
          $ref: '#/components/schemas/Links'
        meta:
          $ref: '#/components/schemas/MetaCves'
      required:
        - data
        - links
        - meta
  
    SystemListOut:
      type: object
      properties:
        data:
          oneOf:
            - type: string
              description: CSV export of the JSON.
            - type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: Host ID.
                    example: INV-ID00-0000-1234
                  type:
                    type: string
                    description: Type of the record.
                    example: system
                  attributes:
                    type: object
                    properties:
                      cve_count:
                        type: integer
                        description: Number of CVE exposures for the system.
                        example: 7
                      inventory_id:
                        type: string
                        description: Host ID.
                        example: INV-ID00-0000-1234
                      last_evaluation:
                        type: string
                        description: Date of last evaluation.
                        example: '2018-09-22T16:00:00+00:00'
                      opt_out:
                        type: boolean
                        description: Opt out status of the system.
                        example: false
                      satellite_managed:
                        type: boolean
                        description: Whether the host is managed by Satellite or not.
                        example: true
                    required:
                      - cve_count
                      - inventory_id
                      - last_evaluation
                      - opt_out
                      - satellite_managed
                required:
                  - id
                  - type
                  - attributes
        links:
          $ref: '#/components/schemas/Links'
        meta:
          $ref: '#/components/schemas/MetaSystems'
      required:
        - data
        - links
        - meta

    VulnerabilitiesOut:
      type: object
      properties:
        data:
          oneOf:
            - type: string
              description: CSV export of the JSON.
            - type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: CVE id.
                    example: CVE-2016-0800
                  type:
                    type: string
                    description: Type of the record.
                    example: cve
                  attributes:
                    type: object
                    properties:
                      cvss2_score:
                        type: string
                        description: String representation of cvss2 score of the CVE.
                        example: '5.800'
                      cvss3_score:
                        type: string
                        description: String representation of cvss3 score of the CVE.
                        example: '4.400'
                      description:
                        type: string
                        description: Description of the CVE.
                        example: A padding oracle flaw was found in the Secure Sockets Layer version 2.0 (SSLv2) protocol. An attacker could...
                      impact:
                        type: string
                        description: Red Hat security impact of the CVE.
                        example: Important
                      public_date:
                        type: string
                        description: String representation of ISO-8601 formatted date of first public disclosure of the CVE.
                        example: '2016-03-01T00:00:00+00:00'
                      synopsis:
                        type: string
                        description: Synopsis of the CVE.
                        example: CVE-2016-0800
                      systems_affected:
                        type: integer
                        description: Number of systems affected by the CVE.
                        example: 7
                    required:
                      - cvss2_score
                      - cvss3_score
                      - description
                      - impact
                      - public_date
                      - synopsis
                      - systems_affected
                required:
                  - id
                  - type
                  - attributes
        links:
          $ref: '#/components/schemas/Links'
        meta:
          $ref: '#/components/schemas/Meta'
      required:
        - data
        - links
        - meta

    VersionOut:
      type: object
      properties:
        application_version:
          oneOf:
            - type: string
            - type: number
          description: Version of application.
          example: 0.1
        database_version:
          oneOf:
            - type: string
            - type: number
          description: Version of database schema.
          example: 1
      required:
        - application_version
        - database_version
