-- ----------------------------------------------------------------------------
-- Vulnerability Engine DB - Development Data Insert
--
-- This file inserts some data for initial development to use.
-- This is intended to be temporary until we get full flow working with
-- real data.
-- ----------------------------------------------------------------------------
INSERT INTO rh_account (id, name) VALUES
(0, '0'), (1, '1'), (2, '2'), (3, '3');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_upload) VALUES
(0, '00000000-0000-0000-0000-000000000000', 'inv-0.example.com', 0, 'https://s3/1', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
(1, '00000000-0000-0000-0000-000000000001', 'inv-1.example.com', 0, 'https://s3/2', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
(2, '00000000-0000-0000-0000-000000000002', 'inv-2.example.com', 0, 'https://s3/3', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload, advisor_evaluated) VALUES
(3, '00000000-0000-0000-0000-000000000003', 'inv-3.example.com', 0, 'https://s3/4', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04'),
(4, '00000000-0000-0000-0000-000000000004', 'inv-4.example.com', 0, 'https://s3/5', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04'),
(5, '00000000-0000-0000-0000-000000000005', 'inv-5.example.com', 0, 'https://s3/6', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, first_reported, last_updated, unchanged_since, last_upload, advisor_evaluated) VALUES
(6, '00000000-0000-0000-0000-000000000006', 'inv-6.example.com', 0, 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2017-12-31 08:22:33-04', '2018-10-04 14:13:12-04', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload) VALUES
(7, '00000000-0000-0000-0000-000000000007', 'inv-7.example.com', 0, 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload) VALUES
(8, '00000000-0000-0000-0000-000000000008', 'inv-0.redhat.com', 1, 'https://s3/8', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(9, '00000000-0000-0000-0000-000000000009', 'inv-0.redhat.com', 1, 'https://s3/9', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(10, '00000000-0000-0000-0000-000000000010', 'inv-0.redhat.com', 1, 'https://s3/10', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(11, '00000000-0000-0000-0000-000000000011', 'inv-0.ibm.com', 2, 'https://s3/11', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_upload, last_evaluation,  when_deleted) VALUES
(12, '00000000-0000-0000-0000-000000000012', 'inv-12.example.com', 0, 'https://s3/12', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04'),
(13, '00000000-0000-0000-0000-000000000013', 'inv-13.example.com', 0, 'https://s3/13', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04'),
(14, '00000000-0000-0000-0000-000000000014', 'inv-14.example.com', 0, 'https://s3/14', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2018-09-23 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_upload, last_evaluation,  advisor_evaluated, stale) VALUES
(15, '00000000-0000-0000-0000-000000000015', 'inv-15.example.com', 0, 'https://s3/15', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', NULL, NULL, '2018-09-23 12:00:00-04', 'F'),
(16, '00000000-0000-0000-0000-000000000016', 'inv-16.example.com', 0, 'https://s3/16', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', NULL, NULL, '2018-09-23 12:00:00-04', 'T'),
(17, '00000000-0000-0000-0000-000000000017', 'inv-17.example.com', 0, 'https://s3/17', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', NULL, NULL, '2018-09-23 12:00:00-04', 'F');

INSERT INTO system_platform (id, inventory_id, display_name, rh_account_id, s3_url, vmaas_json, json_checksum, last_upload, last_evaluation,  advisor_evaluated, stale, opt_out) VALUES
(18, '00000000-0000-0000-0000-000000000018', 'inv-18.example.com', 0, 'https://s3/18', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', NULL, NULL, '2018-09-23 12:00:00-04', 'F', 'T');

INSERT INTO cve_metadata (id, cve, impact_id, cvss3_score, cvss3_metrics, public_date, description, advisories_list, exploits) VALUES
(0, 'CVE-2013-1', 7, NULL, NULL, '2013-11-12 00:00:00+00', 'CVE-2013-1 desc', NULL, false),
(1, 'CVE-2014-1', 5, NULL, NULL, '2014-04-07 00:00:00+00', 'CVE-2014-1 desc', NULL, false),
(2, 'CVE-2016-1', 5, 5.9, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N', '2016-03-01 00:00:00+00', 'CVE-2016-1 desc', '["RHSA-2014:1999"]', true),
(3, 'CVE-2017-1', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-01-24 00:00:00+00', 'CVE-2017-1 desc', NULL, false),
(4, 'CVE-2017-2', 7, 8.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-03-14 00:00:00+00', 'CVE-2017-2 desc', NULL, false),
(5, 'CVE-2017-3', 6, 7.8, 'CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-04-12 14:59:00+00', 'CVE-2017-3 desc', NULL, false),
(6, 'CVE-2017-4', 4, 4.4, 'CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-4 desc', NULL, false),
(7, 'CVE-2017-5', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-5 desc', NULL, false),
(8, 'CVE-2017-6', 5, 5.6, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-6 desc', NULL, false),
(9, 'CVE-2017-7', 5, 5.6, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-7 desc', NULL, false),
(10, 'CVE-2017-8', 5, 5.5, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-8 desc', '["RHSA-2020:3592", "RHSA-2014:1999"]', true),
(11, 'CVE-2018-1', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2018-08-08 00:00:00+00', 'CVE-2018-1 desc', NULL, false),
(12, 'CVE-2018-2', 7, 9.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', '2018-08-09 00:00:00+00', 'CVE-2018-2 desc', NULL, false),
(13, 'CVE-2018-3', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-04-27 00:00:00+00', 'CVE-2018-3 desc', NULL, false),
(14, 'CVE-2018-4', 7, 7.5, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2018-04-17 00:00:00+00', 'CVE-2018-4 desc', NULL, false),
(15, 'CVE-2018-5', 5, 7.0, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2016-09-16T00:00:00+00:00', 'CVE-2018-5 desc', NULL, false),
(16, 'CVE-2018-6', 2, 6.5, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H', '2018-07-24 00:00:00+00', 'CVE-2018-6 desc', NULL, false);

INSERT INTO insights_rule (id, name, active, description_text, summary_text, reboot_required, playbook_count, change_risk, kbase_node_id, reason_text, resolution_text, more_info_text, rule_impact) VALUES
(0, 'CVE_2019_11135_cpu_taa|CVE_2019_11135_CPU_TAA_KERNEL', 'T', 'description', 'summary', 'T', 1, 3, 31276, 'reason', 'resolution', 'more_info', 1),
(1, 'CVE_2018_3639_cpu_kernel|CVE_2018_3639_CPU_BAD_MICROCODE_2', 'T', 'description', 'summary', 'F', 0, 3, NULL, 'reason', 'resolution', 'more_info', 2),
(2, 'CVE_2018_12207_cpu_kernel|CVE_2018_12207_CPU_KERNEL_FOR_SURE', 'T', 'description', 'summary', 'F', 0, 2, 45627, 'reason', 'resolution', 'more_info', 3),
(3, 'CVE_2018_3620_cpu_kernel|CVE_2018_3620_CPU_KERNEL_NEED_UPDATE', 'F', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1),
(4, 'CVE_2019_1125_kernel|CVE_2019_1125_KERNEL_2', 'T', 'description', 'summary', 'T', 1, 3, 328734, 'reason', 'resolution', 'more_info', 3),
(5, 'CVE_2018_12130_cpu_kernel|CVE_2018_12130_CPU_KERNEL_NEED_UPDATE', 'T', 'description', 'summary', 'T', 1, 3, 328734, 'reason', 'resolution', 'more_info', 3),
(6, 'CVE_2018_12130_cpu_kernel|CVE_2018_12130_CPU_KERNEL_BAD_MICROCODE', 'T', 'description', 'summary', 'T', 1, 4, 328734, 'reason', 'resolution', 'more_info', 2);

INSERT INTO insights_rule (id, name, active, rule_only) VALUES
(7, 'CVE_2019_11135_cpu_taa', 'T', 'T'),
(8, 'CVE_2018_3639_cpu_kernel', 'T', 'T'),
(9, 'CVE_2018_12207_cpu_kernel', 'T', 'T'),
(10, 'CVE_2018_3620_cpu_kernel', 'F', 'T'),
(11, 'CVE_2019_1125_kernel', 'T', 'T'),
(12, 'CVE_2018_12130_cpu_kernel', 'T', 'T');

INSERT INTO cve_rule_mapping (cve_id, rule_id) VALUES
(1, 1),
(2, 1),
(3, 2),
(8, 3),
(9, 3),
(8, 4),
(9, 4),
(10, 5),
(11, 5),
(10, 6),
(11, 6),
(1, 8),
(2, 8),
(3, 9),
(8, 10),
(9, 10),
(8, 11),
(9, 11),
(10, 12),
(11, 12);

INSERT INTO system_vulnerabilities (rh_account_id, system_id, cve_id, first_reported, when_mitigated, status_id, rule_id, rule_hit_details) VALUES
(0, 3, 1, '2018-03-01 12:00:00-04', NULL, 3, NULL, NULL),
(0, 3, 2, '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3, 1, NULL),
(0, 3, 3, '2018-03-01 12:00:00-04', NULL, 3, 2, NULL),
(0, 3, 8, '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3, 3, NULL),
(0, 3, 10, '2018-03-01 12:00:00-04', NULL, 3, NULL, NULL),
(0, 4, 1, '2018-10-01 12:00:00-04', NULL, 4, NULL, NULL),
(0, 4, 2, '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4, NULL, NULL),
(0, 4, 3, '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4, NULL, NULL),
(0, 4, 8, '2017-10-01 12:00:00-04', NULL, 4, NULL, NULL),
(0, 4, 9, '2017-10-01 12:00:00-04', '2017-10-01 12:00:00-04', 4, 3, '{"rule_hit": "detail"}'),
(0, 5, 1, '2018-10-03 12:00:00-04', NULL, 5, NULL, NULL),
(0, 5, 2, '2018-10-03 12:00:00-04', NULL, 5, 1, NULL),
(0, 5, 3, '2018-10-03 12:00:00-04', NULL, 5, 2, NULL),
(0, 5, 8, '2018-08-03 12:00:00-04', '2018-08-03 12:00:00-04', 5, 4, '{"rule_hit": "detail"}'),
(0, 5, 9, '2018-08-03 12:00:00-04', NULL, 5, NULL, NULL),
(0, 5, 10, '2018-08-03 12:00:00-04', NULL, 5, 5, '{"rule_hit": "detail"}'),
(0, 5, 11, '2017-10-03 12:00:00-04', NULL, 5, 5, '{"rule_hit": "detail"}'),
(0, 5, 15, '2018-10-01 12:00:00-04', '2018-10-03 12:00:00-04', 5, NULL, NULL),
(0, 6, 10, '2018-08-03 12:00:00-04', '2018-09-22 12:00:00-04', 5, NULL, NULL),
(0, 6, 11, '2017-10-03 12:00:00-04', '2018-09-22 12:00:00-04', 5, NULL, NULL),
(0, 7, 1, '2018-09-01 12:00:00-04', '2018-09-22 12:00:00-04', 2, NULL, NULL),
(0, 7, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 8, '2018-07-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 9, '2018-02-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 10, '2018-02-01 12:00:00-04', '2018-09-01 12:00:00-04', 2, 6, '{"rule_hit": "detail"}'),
(0, 7, 11, '2018-02-01 12:00:00-04', '2018-09-01 12:00:00-04', 2, 6, '{"rule_hit": "detail"}'),
(0, 7, 12, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 13, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 14, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 7, 16, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0 ,7, 4, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0 ,7, 7, '2018-04-01 12:00:00-04', '2018-09-01 12:00:00-04', 2, NULL, NULL),
(0, 7, 6, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(1, 8, 6, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(1, 8, 10, '2018-08-03 12:00:00-04', NULL, 5, NULL, NULL),
(1, 8, 11, '2017-10-03 12:00:00-04', NULL, 5, NULL, NULL),
(1, 8, 15, '2018-10-01 12:00:00-04', '2018-10-03 12:00:00-04', 5, NULL, NULL),
(1, 8, 1, '2018-09-01 12:00:00-04', '2018-09-22 12:00:00-04', 2, NULL, NULL),
(1, 8, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(1, 8, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(1, 9, 10, '2018-08-03 12:00:00-04', NULL, 5, NULL, NULL),
(1, 9, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(1, 9, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 12, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 12, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 13, 10, '2018-08-03 12:00:00-04', NULL, 5, NULL, NULL),
(0, 13, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 13, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 15, 8, '2018-04-01 12:00:00-04', NULL, 2, 4, '{"rule_hit": "detail"}'),
(0, 18, 10, '2018-08-03 12:00:00-04', NULL, 5, NULL, NULL),
(0, 18, 2, '2018-09-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 18, 3, '2018-04-01 12:00:00-04', NULL, 2, NULL, NULL),
(0, 18, 8, '2018-04-01 12:00:00-04', NULL, 2, 4, '{"rule_hit": "detail"}');

INSERT INTO system_vulnerabilities (rh_account_id, system_id, cve_id, first_reported, when_mitigated, status_id, rule_id, rule_hit_details, mitigation_reason) VALUES
(0, 3, 9, '2018-03-01 12:00:00-04', NULL, 3, 10, NULL, 'SELinux mitigates the issue'),
(0, 17, 1, '2018-03-01 12:00:00-04', '2018-03-02 12:00:00-04', 1, 8, NULL, 'SELinux mitigates the issue'),
(0, 17, 9, '2018-03-01 12:00:00-04', NULL, 1, 4, NULL, 'SELinux mitigates the issue');

INSERT INTO cve_account_data (cve_id, rh_account_id, business_risk_id, business_risk_text, status_id, status_text) VALUES
(10, 1, 0, NULL, 0, 'status_text0'),
(10, 2, 2, 'risk_text0', 0, NULL),
(1, 2, 0, NULL, 0, NULL),
(2, 2, 3, 'risk_text1', 1, 'status_text1'),
(11, 1, 1, 'risk_text2', 0, NULL),
(12, 1, 2, NULL, 2, NULL),
(5, 2, 1, 'risk_text3', 2, 'status_text2');

INSERT INTO repo (id, name) VALUES
(1, 'repo1'),
(2, 'repo2');

INSERT INTO system_repo (system_id, repo_id) VALUES
(1, 1),
(2, 1);

INSERT INTO timestamp_kv (name, value) VALUES
('last_eval_repo_based', '2018-04-05T01:23:45+02:00');

SELECT setval('system_platform_id_seq', 100);
SELECT setval('cve_metadata_id_seq', 100);
SELECT setval('rh_account_id_seq', 100);
SELECT setval('insights_rule_id_seq', 100);
