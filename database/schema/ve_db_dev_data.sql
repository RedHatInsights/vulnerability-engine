-- ----------------------------------------------------------------------------
-- Vulnerability Engine DB - Development Data Insert
--
-- This file inserts some data for initial development to use.
-- This is intended to be temporary until we get full flow working with
-- real data.
-- ----------------------------------------------------------------------------
INSERT INTO rh_account (id, name) VALUES
(0, '0'), (1, '1'), (2, '2');

INSERT INTO system_platform (id, inventory_id, rh_account_id, s3_url, vmaas_json, json_checksum, last_upload) VALUES
(0, 'INV-0', 0, 'https://s3/1', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
(1, 'INV-1', 0, 'https://s3/2', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
(2, 'INV-2', 0, 'https://s3/3', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload) VALUES
(3, 'INV-3', 0, 'https://s3/4', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(4, 'INV-4', 0, 'https://s3/5', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(5, 'INV-5', 0, 'https://s3/6', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, rh_account_id, s3_url, vmaas_json, json_checksum, first_reported, last_updated, unchanged_since, last_upload) VALUES
(6, 'INV-6', 0, 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2017-12-31 08:22:33-04', '2018-10-04 14:13:12-04', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload) VALUES
(7, 'INV-7', 0, 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (id, inventory_id, rh_account_id, s3_url, vmaas_json, json_checksum, last_evaluation, last_upload) VALUES
(8, 'INV-8', 1, 'https://s3/8', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(9, 'INV-9', 1, 'https://s3/9', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04'),
(10, 'INV-10', 1, 'https://s3/10', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04');

INSERT INTO cve_metadata (id, cve, impact_id, cvss3_score, cvss3_metrics, public_date, description) VALUES
(0, 'CVE-2013-1', 7, NULL, NULL, '2013-11-12 00:00:00+00', 'CVE-2013-1 desc'),
(1, 'CVE-2014-1', 5, NULL, NULL, '2014-04-07 00:00:00+00', 'CVE-2014-1 desc'),
(2, 'CVE-2016-1', 5, 5.9, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N', '2016-03-01 00:00:00+00', 'CVE-2016-1 desc'),
(3, 'CVE-2017-1', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-01-24 00:00:00+00', 'CVE-2017-1 desc'),
(4, 'CVE-2017-2', 7, 8.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-03-14 00:00:00+00', 'CVE-2017-2 desc'),
(5, 'CVE-2017-3', 6, 7.8, 'CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-04-12 14:59:00+00', 'CVE-2017-3 desc'),
(6, 'CVE-2017-4', 4, 4.4, 'CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-4 desc'),
(7, 'CVE-2017-5', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-5 desc'),
(8, 'CVE-2017-6', 5, 5.6, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-6 desc'),
(9, 'CVE-2017-7', 5, 5.6, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-7 desc'),
(10, 'CVE-2017-8', 5, 5.5, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-8 desc'),
(11, 'CVE-2018-1', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2018-08-08 00:00:00+00', 'CVE-2018-1 desc'),
(12, 'CVE-2018-2', 7, 9.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', '2018-08-09 00:00:00+00', 'CVE-2018-2 desc'),
(13, 'CVE-2018-3', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-04-27 00:00:00+00', 'CVE-2018-3 desc'),
(14, 'CVE-2018-4', 7, 7.5, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2018-04-17 00:00:00+00', 'CVE-2018-4 desc'),
(15, 'CVE-2018-5', 5, 7.0, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2016-09-16T00:00:00+00:00', 'CVE-2018-5 desc'),
(16, 'CVE-2018-6', 2, 6.5, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H', '2018-07-24 00:00:00+00', 'CVE-2018-6 desc');


INSERT INTO system_vulnerabilities (system_id, cve_id, first_reported, when_mitigated, status_id) VALUES
(3, 1, '2018-03-01 12:00:00-04', NULL, 3),
(3, 2, '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3),
(3, 3, '2018-03-01 12:00:00-04', NULL, 3),
(3, 8, '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3),
(3, 9, '2018-03-01 12:00:00-04', NULL, 3),
(3, 10, '2018-03-01 12:00:00-04', NULL, 3),
(4, 1, '2018-10-01 12:00:00-04', NULL, 4),
(4, 2, '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4),
(4, 3, '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4),
(4, 8, '2017-10-01 12:00:00-04', NULL, 4),
(5, 1, '2018-10-03 12:00:00-04', NULL, 5),
(5, 2, '2018-10-03 12:00:00-04', NULL, 5),
(5, 3, '2018-10-03 12:00:00-04', NULL, 5),
(5, 8, '2018-08-03 12:00:00-04', NULL, 5),
(5, 9, '2018-08-03 12:00:00-04', NULL, 5),
(5, 10, '2018-08-03 12:00:00-04', NULL, 5),
(5, 11, '2017-10-03 12:00:00-04', NULL, 5),
(5, 15, '2018-10-01 12:00:00-04', '2018-10-03 12:00:00-04', 5),
(7, 1, '2018-09-01 12:00:00-04', '2018-09-22 12:00:00-04', 2),
(7, 2, '2018-09-01 12:00:00-04', NULL, 2),
(7, 3, '2018-04-01 12:00:00-04', NULL, 2),
(7, 8, '2018-07-01 12:00:00-04', NULL, 2),
(7, 9, '2018-02-01 12:00:00-04', NULL, 2),
(7, 10, '2018-02-01 12:00:00-04', NULL, 2),
(7, 11, '2018-02-01 12:00:00-04', '2018-09-01 12:00:00-04', 2),
(7, 12, '2018-09-01 12:00:00-04', NULL, 2),
(7, 13, '2018-09-01 12:00:00-04', NULL, 2),
(7, 14, '2018-09-01 12:00:00-04', NULL, 2),
(7, 16, '2018-09-01 12:00:00-04', NULL, 2),
(7, 4, '2018-09-01 12:00:00-04', NULL, 2),
(7, 7, '2018-04-01 12:00:00-04', '2018-09-01 12:00:00-04', 2),
(8, 6, '2018-04-01 12:00:00-04', NULL, 2),
(8, 10, '2018-08-03 12:00:00-04', NULL, 5),
(8, 11, '2017-10-03 12:00:00-04', NULL, 5),
(8, 15, '2018-10-01 12:00:00-04', '2018-10-03 12:00:00-04', 5),
(8, 1, '2018-09-01 12:00:00-04', '2018-09-22 12:00:00-04', 2),
(8, 2, '2018-09-01 12:00:00-04', NULL, 2),
(8, 3, '2018-04-01 12:00:00-04', NULL, 2),
(9, 10, '2018-08-03 12:00:00-04', NULL, 5),
(9, 2, '2018-09-01 12:00:00-04', NULL, 2),
(9, 3, '2018-04-01 12:00:00-04', NULL, 2);

INSERT INTO cve_account_data (cve_id, rh_account_id, business_risk_id, business_risk_text, status_id, status_text) VALUES
(10, 1, 0, NULL, 0, 'status_text0'),
(10, 2, 2, 'risk_text0', 0, NULL),
(1, 2, 0, NULL, 0, NULL),
(2, 2, 3, 'risk_text1', 1, 'status_text1'),
(11, 1, 1, 'risk_text2', 0, NULL),
(12, 1, 2, NULL, 2, NULL);

INSERT INTO repo (id, name) VALUES
(1, 'repo1'),
(2, 'repo2');

INSERT INTO system_repo (system_id, repo_id) VALUES
(1, 1),
(2, 1);

INSERT INTO timestamp_kv (name, value) VALUES
('last_eval_repo_based', '2018-04-05T01:23:45+02:00');

SELECT refresh_all_cached_counts();

SELECT setval('system_platform_id_seq', 100);
SELECT setval('cve_metadata_id_seq', 100);
SELECT setval('rh_account_id_seq', 100);