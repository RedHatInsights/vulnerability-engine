-- ----------------------------------------------------------------------------
-- Vulnerability Engine DB - Development Data Insert
--
-- This file inserts some data for initial development to use.
-- This is intended to be temporary until we get full flow working with
-- real data.
-- ----------------------------------------------------------------------------
INSERT INTO system_platform (inventory_id, rh_account, s3_url, vmaas_json, json_checksum) VALUES
('INV-0', '0', 'https://s3/1', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1'),
('INV-1', '0', 'https://s3/2', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1'),
('INV-2', '0', 'https://s3/3', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1');

INSERT INTO system_platform (inventory_id, rh_account, s3_url, vmaas_json, json_checksum, last_evaluation) VALUES
('INV-3', '0', 'https://s3/4', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
('INV-4', '0', 'https://s3/5', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04'),
('INV-5', '0', 'https://s3/6', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (inventory_id, rh_account, s3_url, vmaas_json, json_checksum, first_reported, last_updated, unchanged_since) VALUES
('INV-6', '0', 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2017-12-31 08:22:33-04', '2018-10-04 14:13:12-04', '2018-09-22 12:00:00-04');

INSERT INTO system_platform (inventory_id, rh_account, s3_url, vmaas_json, json_checksum, last_evaluation, satellite_managed) VALUES
('INV-7', '0', 'https://s3/7', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '1', '2018-09-22 12:00:00-04', 'TRUE');


INSERT INTO cve_metadata (cve, impact_id, cvss3_score, cvss3_metrics, public_date, description) VALUES
('CVE-2013-1', 7, NULL, NULL, '2013-11-12 00:00:00+00', 'CVE-2013-1 desc'),
('CVE-2014-1', 5, NULL, NULL, '2014-04-07 00:00:00+00', 'CVE-2014-1 desc'),
('CVE-2016-1', 5, 5.9, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N', '2016-03-01 00:00:00+00', 'CVE-2016-1 desc'),
('CVE-2017-1', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-01-24 00:00:00+00', 'CVE-2017-1 desc'),
('CVE-2017-2', 7, 8.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-03-14 00:00:00+00', 'CVE-2017-2 desc'),
('CVE-2017-3', 6, 7.8, 'CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-04-12 14:59:00+00', 'CVE-2017-3 desc'),
('CVE-2017-4', 4, 4.4, 'CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-4 desc'),
('CVE-2017-5', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00+00', 'CVE-2017-5 desc'),
('CVE-2017-6', 5, 5.6, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-6 desc'),
('CVE-2017-7', 5, 5.6, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-7 desc'),
('CVE-2017-8', 5, 5.5, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00+00', 'CVE-2017-8 desc'),
('CVE-2018-1', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2018-08-08 00:00:00+00', 'CVE-2018-1 desc'),
('CVE-2018-2', 7, 9.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', '2018-08-09 00:00:00+00', 'CVE-2018-2 desc'),
('CVE-2018-3', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-04-27 00:00:00+00', 'CVE-2018-3 desc'),
('CVE-2018-4', 7, 7.5, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2018-04-17 00:00:00+00', 'CVE-2018-4 desc'),
('CVE-2018-5', 5, 7.0, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2016-09-16T00:00:00+00:00', 'CVE-2018-5 desc'),
('CVE-2018-6', 2, 6.5, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H', '2018-07-24 00:00:00+00', 'CVE-2018-6 desc');


INSERT INTO system_vulnerabilities (inventory_id, cve, first_reported, when_mitigated, status_id) VALUES
('INV-3', 'CVE-2014-1', '2018-03-01 12:00:00-04', NULL, 3),
('INV-3', 'CVE-2016-1', '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3),
('INV-3', 'CVE-2017-1', '2018-03-01 12:00:00-04', NULL, 3),
('INV-3', 'CVE-2017-6', '2018-03-01 12:00:00-04', '2018-09-01 12:00:00-04', 3),
('INV-3', 'CVE-2017-7', '2018-03-01 12:00:00-04', NULL, 3),
('INV-3', 'CVE-2017-8', '2018-03-01 12:00:00-04', NULL, 3),
('INV-4', 'CVE-2014-1', '2018-10-01 12:00:00-04', NULL, 4),
('INV-4', 'CVE-2016-1', '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4),
('INV-4', 'CVE-2017-1', '2017-10-01 12:00:00-04', '2018-01-03 12:00:00-04', 4),
('INV-4', 'CVE-2017-6', '2017-10-01 12:00:00-04', NULL, 4),
('INV-5', 'CVE-2014-1', '2018-10-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2016-1', '2018-10-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2017-1', '2018-10-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2017-6', '2018-08-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2017-7', '2018-08-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2017-8', '2018-08-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2018-1', '2017-10-03 12:00:00-04', NULL, 5),
('INV-5', 'CVE-2018-5', '2018-10-01 12:00:00-04', '2018-10-03 12:00:00-04', 5),
('INV-7', 'CVE-2014-1', '2018-09-01 12:00:00-04', '2018-09-22 12:00:00-04', 2),
('INV-7', 'CVE-2016-1', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-1', '2018-04-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-6', '2018-07-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-7', '2018-02-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-8', '2018-02-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2018-1', '2018-02-01 12:00:00-04', '2018-09-01 12:00:00-04', 2),
('INV-7', 'CVE-2018-2', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2018-3', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2018-4', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2018-6', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-2', '2018-09-01 12:00:00-04', NULL, 2),
('INV-7', 'CVE-2017-5', '2018-04-01 12:00:00-04', '2018-09-01 12:00:00-04', 2),
('INV-7', 'CVE-2017-4', '2018-04-01 12:00:00-04', NULL, 2);

INSERT INTO repo (id, name) VALUES
(1, 'repo1'),
(2, 'repo2');

INSERT INTO system_repo (inventory_id, repo_id) VALUES
('INV-1', 1),
('INV-2', 1);

INSERT INTO timestamp_kv (name, value) VALUES
('last_eval_repo_based', '2018-04-05T01:23:45+02:00');

SELECT refresh_all_cached_counts();
