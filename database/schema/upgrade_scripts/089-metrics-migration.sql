-- usage statistics table
CREATE TABLE IF NOT EXISTS usage_statistics (
  id SERIAL,
  recorded DATE,
  name TEXT NOT NULL, CHECK (NOT empty(name)),
  cve_status_usage INT,
  system_cve_status_usage INT,
  cve_business_risk_usage INT,
  PRIMARY KEY (id)
) TABLESPACE pg_default;

GRANT SELECT, INSERT, UPDATE, DELETE ON usage_statistics TO ve_db_user_metrics;
GRANT SELECT, INSERT, UPDATE, DELETE ON usage_statistics TO ve_db_user_manager;

GRANT SELECT ON TABLE usage_statistics TO ve_db_user_advisor_listener;
GRANT SELECT ON TABLE usage_statistics TO ve_db_user_evaluator;
GRANT SELECT ON TABLE usage_statistics TO ve_db_user_listener;
GRANT SELECT ON TABLE usage_statistics TO ve_db_user_taskomatic;
GRANT SELECT ON TABLE usage_statistics TO ve_db_user_vmaas_sync;

GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_metrics;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_manager;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_advisor_listener;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_evaluator;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_listener;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_taskomatic;
GRANT SELECT, USAGE ON SEQUENCE usage_statistics_id_seq TO ve_db_user_vmaas_sync;
