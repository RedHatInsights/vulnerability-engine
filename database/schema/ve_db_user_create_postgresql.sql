-- ---------------------------------------------------------------------------
-- Vulnerability Engine DB Users
-- ---------------------------------------------------------------------------

-- user for evaluator component
CREATE USER ve_db_user_evaluator;

-- user for listener component
CREATE USER ve_db_user_listener;

-- user for UI manager component
CREATE USER ve_db_user_manager;

-- user for VMaaS CVE sync
CREATE USER ve_db_user_vmaas_sync;

-- user for metrics cronjob
CREATE USER ve_db_user_metrics;

-- user for taskomatic component
CREATE USER ve_db_user_taskomatic;

-- user for advisor listener
CREATE USER ve_db_user_advisor_listener;

-- user and roles for cyndi
-- clowder deployemnt already have cyndi roles in DB
DO $$
BEGIN
  CREATE ROLE cyndi_admin;
  EXCEPTION WHEN DUPLICATE_OBJECT THEN
  RAISE NOTICE '`cyndi_admin` role already exists';
END
$$;
DO $$
BEGIN
  CREATE ROLE cyndi_reader;
  EXCEPTION WHEN DUPLICATE_OBJECT THEN
  RAISE NOTICE '`cyndi_reader` role already exists';
END
$$;

DO $$
BEGIN
  CREATE USER cyndi;
  EXCEPTION WHEN DUPLICATE_OBJECT THEN
  RAISE NOTICE 'user `cyndi` already exists';
END
$$;

GRANT cyndi_admin TO cyndi;
