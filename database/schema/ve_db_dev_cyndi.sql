-- cyndi local dev seed and setup, on other deployments it is done by cyndi
CREATE TABLE IF NOT EXISTS inventory.hosts_v1_1 (
    id TEXT PRIMARY KEY, -- ! In Cyndi here is UUID, since we are using TEXT everywhere in local db and nonUUID TEXTs, lets keep this TEXT
    account character varying(10) NOT NULL,
    display_name character varying(200) NOT NULL,
    tags jsonb NOT NULL,
    updated timestamp with time zone NOT NULL,
    created timestamp with time zone NOT NULL,
    stale_timestamp timestamp with time zone NOT NULL,
    system_profile jsonb NOT NULL
);

-- This view should be queried instead
CREATE OR REPLACE VIEW inventory.hosts AS
SELECT
    id,
    account,
    display_name,
    created,
    updated,
    stale_timestamp,
    stale_timestamp + INTERVAL '1' DAY * 7 AS stale_warning_timestamp,
    stale_timestamp + INTERVAL '1' DAY * 14 AS culled_timestamp,
    tags,
    system_profile
FROM inventory.hosts_v1_1;

GRANT SELECT ON inventory.hosts TO cyndi_reader;

INSERT INTO inventory.hosts_v1_1 VALUES ('INV-0', '0', 'inv-0.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-0"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-1', '0', 'inv-1.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-1"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-2', '0', 'inv-2.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-2"}, {"namespace": "vulnerability", "key": "usage", "value": "NAS"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-3', '0', 'inv-3.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-3"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-4', '0', 'inv-4.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-4"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-5', '0', 'inv-5.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-5"}, {"namespace": "vulnerability", "key": "usage", "value": "NAS"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-6', '0', 'inv-6.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-6"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-7', '0', 'inv-7.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-7"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-8', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-8"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-9', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-9"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-10', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-10"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-11', '2', 'inv-0.ibm.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-11"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-12', '0', 'inv-12.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-12"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-13', '0', 'inv-13.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-13"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-14', '0', 'inv-14.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-14"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-15', '0', 'inv-15.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-15"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-16', '0', 'inv-16.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-16"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('INV-17', '0', 'inv-17.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-17"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false}') ON CONFLICT DO NOTHING;
