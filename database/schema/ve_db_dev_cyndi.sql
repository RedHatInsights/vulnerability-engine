-- cyndi local dev seed and setup, on other deployments it is done by cyndi
CREATE TABLE IF NOT EXISTS inventory.hosts_v1_1 (
    id UUID PRIMARY KEY,
    account character varying(10) NOT NULL,
    display_name character varying(200) NOT NULL,
    tags jsonb NOT NULL,
    updated timestamp with time zone NOT NULL,
    created timestamp with time zone NOT NULL,
    stale_timestamp timestamp with time zone NOT NULL,
    system_profile jsonb NOT NULL,
    insights_id UUID
);

GRANT SELECT, UPDATE, INSERT ON inventory.hosts_v1_1 TO cyndi_admin;

-- This view should be queried instead
CREATE OR REPLACE VIEW inventory.hosts AS
SELECT
    id,
    account,
    display_name,
    created,
    updated,
    stale_timestamp,
    stale_timestamp + INTERVAL '1' DAY * 7 AS stale_warning_timestamp,
    stale_timestamp + INTERVAL '1' DAY * 14 AS culled_timestamp,
    tags,
    system_profile,
    insights_id
FROM inventory.hosts_v1_1;

GRANT SELECT ON inventory.hosts TO cyndi_reader;

INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000000', '0', 'inv-0.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-0"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000000') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000001', '0', 'inv-1.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-1"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000001') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000002', '0', 'inv-2.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-2"}, {"namespace": "vulnerability", "key": "usage", "value": "NAS"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 8, "minor": 2}}', '11111111-0000-0000-0000-000000000002') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000003', '0', 'inv-3.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-3"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 2}}', '11111111-0000-0000-0000-000000000003') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000004', '0', 'inv-4.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-4"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 8, "minor": 2}}', '11111111-0000-0000-0000-000000000004') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000005', '0', 'inv-5.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-5"}, {"namespace": "vulnerability", "key": "usage", "value": "NAS"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 8, "minor": 3}}', '11111111-0000-0000-0000-000000000005') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000006', '0', 'inv-6.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-6"}, {"namespace": "vulnerability", "key": "usage", "value": "personal"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 8, "minor": 3}}', '11111111-0000-0000-0000-000000000006') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000007', '0', 'inv-7.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-7"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "CentOS", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000007') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000008', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-8"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "N/A"}}', '11111111-0000-0000-0000-000000000008') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000009', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-9"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 7, "minor": 9}}', '11111111-0000-0000-0000-000000000009') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000010', '1', 'inv-0.redhat.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-10"}, {"namespace": "vulnerability", "key": "corp", "value": "redhat"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 7, "minor": 9}}', '11111111-0000-0000-0000-000000000010') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000011', '2', 'inv-0.ibm.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-11"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 7, "minor": 4}}', '11111111-0000-0000-0000-000000000011') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000012', '0', 'inv-12.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-12"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 7, "minor": 4}}', '11111111-0000-0000-0000-000000000012') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000013', '0', 'inv-13.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-13"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 7, "minor": 8}}', '11111111-0000-0000-0000-000000000013') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000014', '0', 'inv-14.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-14"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 7, "minor": 8}}', '11111111-0000-0000-0000-000000000014') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000015', '0', 'inv-15.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-15"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "RHEL", "major": 7, "minor": 9}}', '11111111-0000-0000-0000-000000000015') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000016', '0', 'inv-16.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-16"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000016') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000017', '0', 'inv-17.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-17"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 2}}', '11111111-0000-0000-0000-000000000017') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000018', '0', 'inv-18.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-18"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 3}}', '11111111-0000-0000-0000-000000000018') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('38025376-77c3-4848-989c-d0d417456f9c', '0', 'listener-test.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "listener-test"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": false, "operating_system": {"name": "RHEL", "major": 8, "minor": 3}}', '11111111-0000-0000-0000-000000000020') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000020', '0', 'inv-20.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-20"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "CentOS", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000020') ON CONFLICT DO NOTHING;
INSERT INTO inventory.hosts_v1_1 VALUES ('00000000-0000-0000-0000-000000000021', '0', 'inv-21.example.com', '[{"namespace": "vulnerability", "key": "system_name", "value": "inv-21"}, {"namespace": "vulnerability", "key": "usage", "value": "server"}]', '2018-09-22 12:00:00-04', '2018-09-22 12:00:00-04', '2030-07-21 05:35:53.682554+00', '{"sap_system": true, "operating_system": {"name": "CentOS", "major": 8, "minor": 1}}', '11111111-0000-0000-0000-000000000021') ON CONFLICT DO NOTHING;
