version: '3'

services:
  mock:
    container_name: vulnerability-engine-mock
    build: ./mock
    image: vulnerability-engine/mock:latest
    restart: unless-stopped
    ports:
      - 8080:8080

  server:
    container_name: vulnerability-engine-server
    build: ./server
    image: vulnerability-engine/server:latest
    restart: unless-stopped
    ports:
      - 8000:8000

  database:
    container_name: vulnerability-engine-database
    build: ./database
    image: vulnerability-engine/database:latest
    restart: unless-stopped
    env_file:
          - ./conf/database-connection.env
          - ./conf/database-user-admin.env
          - ./conf/database-user-reader.env
          - ./conf/database-user-writer.env
    ports:
          - 5432:5432
    volumes:
          - vulnerability-engine-db-data:/var/lib/pgsql/data

volumes:
  vulnerability-engine-db-data:
