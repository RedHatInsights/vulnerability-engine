#!/usr/bin/bash

TESTDIR=$1
if [ ! -d "$TESTDIR" ] ; then
    echo "usage: $(basename $0) <testdir>" >&2
    exit 1
fi

# for listener copy common code
if [ "$TESTDIR" == "listener" ] ; then
    cp -r common/ listener/
fi

# for evaluator copy common code
if [ "$TESTDIR" == "evaluator" ] ; then
    cp -r common/ evaluator/
fi

# for manager copy also common code
if [ "$TESTDIR" == "manager" ] ; then
    cp -r common/ manager/
fi

(
# Go to script's directory
cd "$TESTDIR"

rc=0

# Run pylint
find . -iname '*.py' | xargs pylint --rcfile=../pylintrc
rc=$(($rc+$?))

exit $rc
)

