"""
Fixtures for notificator tests
"""
import pytest
import asyncpg


@pytest.fixture(scope="function")
async def asyncpg_pool(event_loop, pg_db_func):
    """Creates asyncpg pool fixture"""
    dsn = pg_db_func.dsn()
    dsn_str = f"postgres://{dsn['user']}@{dsn['host']}:{dsn['port']}/{dsn['database']}"

    pool = await asyncpg.create_pool(
        dsn=dsn_str,
        loop=event_loop,
    )
    yield pool
    await pool.close()
