# -*- coding: utf-8 -*-
# pylint: disable=no-self-use
"""
Unit tests for listener module
"""

from listener.archive_parser import ArchiveParser

INSIGHTS_ARCHIVE_FILE = 'tests/listener_tests/insights-archive-rhel7.tar.gz'

class TestArchiveParser:
    """Unit tests for vulnerability-listener."""

    def test_archive_parser(self):
        """test_archive_parser"""
        parser = ArchiveParser(INSIGHTS_ARCHIVE_FILE)
        parser.parse()
        assert parser.package_list
        assert 'alsa-firmware-0:1.0.28-2.el7.noarch' in parser.package_list
        assert parser.repo_list
        assert 'rhel-7-server-optional-rpms' in parser.repo_list
        assert not parser.modules_list
