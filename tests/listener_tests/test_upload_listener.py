# -*- coding: utf-8 -*-
# pylint: disable=no-self-use
"""
Unit tests for listener module
"""

from listener.upload_listener import format_vmaas_request

# We should refactor upload_listener to be a class where db and other things
# are initialized in __init__() method.  This would allow us to override
# those things in unit tests here.

PACKAGE_LIST = ['package-a', 'package-b']
REPO_LIST = ['repo-c', 'repo-d']
MODULES_LIST = ['module-e', 'module-f']
RESULT_JSON = '{"package_list": ["package-a", "package-b"], ' \
              '"repository_list": ["repo-c", "repo-d"], ' \
              '"modules_list": ["module-e", "module-f"]}'

class TestUploadListner:
    """Unit tests for vulnerability-listener."""

    def test_format_vmaas_request(self):
        """test_format_vmaas_request"""
        result = format_vmaas_request(PACKAGE_LIST, repo_list=REPO_LIST, modules_list=MODULES_LIST)
        assert result
        assert result == RESULT_JSON
