# -*- coding: utf-8 -*-
# pylint:disable=missing-docstring
import psycopg2
import pytest

from ..utils import restore_db
from common import database_handler


@pytest.fixture(scope="module")
def pg_db_conn(pg_db_mod):
    """Returns connection to PostgreSQL database."""
    conn = psycopg2.connect(**pg_db_mod.dsn())
    yield conn
    conn.close()


@pytest.fixture
def cleanup(request):
    def db_cleanup():
        restore_db(database_handler.pg_testing)

    request.addfinalizer(db_cleanup)
