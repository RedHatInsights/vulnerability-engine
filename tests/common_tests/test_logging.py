# -*- coding: utf-8 -*-
# pylint: disable=no-self-use
"""
Test logging.
"""
import os
import logging
from common.logging import init_logging

class TestLogging:
    """TestLogging"""
    def test_init_logging_no_cw(self, caplog):
        """test_init_logging_no_cw"""
        with caplog.at_level(logging.INFO):
            init_logging(num_servers=4)
        assert caplog.records[0].msg == "CloudWatch logging disabled due to missing access key"
        caplog.clear()

    def test_init_logging_cw_err(self, caplog):
        """test_init_logging_cw_err"""
        os.environ["CW_AWS_ACCESS_KEY_ID"] = "cw-aws-access-key-id"
        os.environ["CW_AWS_SECRET_ACCESS_KEY"] = "cw-aws-secret-access-key"
        with caplog.at_level(logging.INFO):
            init_logging(num_servers=4)
        assert caplog.records[0].msg.startswith("Unable to enable CloudWatch logging:")
        caplog.clear()
        del os.environ["CW_AWS_ACCESS_KEY_ID"]
        del os.environ["CW_AWS_SECRET_ACCESS_KEY"]
