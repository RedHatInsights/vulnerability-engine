# -*- coding: utf-8 -*-
# pylint:disable=missing-docstring
import asyncpg
import psycopg2
import pytest
import common.database_handler as db_handler


@pytest.fixture(scope="module")
def pg_db_conn(pg_db_mod):
    """Returns connection to PostgreSQL database."""
    conn = psycopg2.connect(**pg_db_mod.dsn())
    yield conn
    conn.close()


@pytest.fixture(scope="function")
async def asyncio_conn(event_loop) -> asyncpg.Connection:
    """Returns asyncpg connection"""
    aconn = await asyncpg.connect(
        host=db_handler.DB_HOST, port=db_handler.DB_PORT, user=db_handler.DB_USER, password=db_handler.DB_PASS, database=db_handler.DB_NAME, loop=event_loop
    )
    yield aconn
    await aconn.close()
