# -*- coding: utf-8 -*-
# pylint: disable=missing-docstring,too-many-public-methods,invalid-name
"""
Manager read only mode tests.
"""
from common.config import Config
from .vuln_testcase import FlaskTestCase

CSV_EXPORT_ENDPOINTS = ('cves/CVE-2016-1/affected_systems', 'systems',
                        'systems/00000000-0000-0000-0000-000000000004/cves', 'vulnerabilities/cves')
CFG = Config()


class TestReadOnly(FlaskTestCase):

    def test_status(self, monkeypatch):
        monkeypatch.setattr(CFG, 'read_only_mode', 1)
        self.vfetch('status', data='{"inventory_id": "00000000-0000-0000-0000-000000000005", "cve":"CVE-2014-1", "status_id":2}',
                    method='PATCH').check_response(status_code=503)

    def test_opt_out(self, monkeypatch):
        monkeypatch.setattr(CFG, 'read_only_mode', 1)
        response = self.vfetch("systems/00000000-0000-0000-0000-000000000004/opt_out?value=true", data="", method="PATCH")
        assert response.status_code == 503

    def test_delete(self, monkeypatch):
        monkeypatch.setattr(CFG, 'read_only_mode', 1)
        response = self.vfetch("systems/00000000-0000-0000-0000-000000000004", method="DELETE")
        assert response.status_code == 503
