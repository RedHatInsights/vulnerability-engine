-- ----------------------------------------------------------------------------
-- Vulnerability Engine DB - Unit Tests Data
-- ----------------------------------------------------------------------------

INSERT INTO system_platform (inventory_id, rh_account, s3_url, vmaas_json, json_checksum, first_reported, last_updated, unchanged_since, satellite_managed, last_evaluation, opt_out, cve_count_cache) VALUES
('INV-ID00-0000-0000', '00000000', 'https://localhost/s3/111111', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 0, NULL, 0, 0),
('INV-ID00-0000-1111', '00000000', 'https://localhost/s3/222222', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 0, NULL, 0, 0),
('INV-ID00-0000-2222', '00000000', 'https://localhost/s3/333333', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 0, NULL, 0, 0),
('INV-ID00-0000-3333', '00000000', 'https://localhost/s3/444444', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 0, NULL, 0, 0),
('INV-ID00-0000-4444', '00000000', 'https://localhost/s3/555555', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 1, '2018-10-04 14:13:12', 0, 2),
('INV-ID00-0000-5555', '00000000', 'https://localhost/s3/666666', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2015-12-31 08:22:33', '2016-10-04 08:22:33', '2016-09-22 09:33:22', 0, '2018-10-04 14:13:12', 0, 7),
('INV-ID00-0000-6666', '00000000', 'https://localhost/s3/777777', '{ "package_list": [ "kernel-2.6.32-696.20.1.el6.x86_64" ]}', '11111111', '2017-12-31 08:22:33', '2018-10-04 14:13:12', '2018-09-22 12:00:00', 0, '2018-10-04 14:13:12', 0, 0);


INSERT INTO cve_metadata (cve, impact_id, cvss3_score, cvss3_metrics, public_date, description, modified_date) VALUES
('CVE-2013-4480', 7, NULL, NULL, '2013-11-12 00:00:00', 'CVE-2013-4480 desc', '2018-09-22 12:00:00'),
('CVE-2014-0160', 5, NULL, NULL, '2014-04-07 00:00:00', 'CVE-2014-0160 desc', '2018-09-22 12:00:00'),
('CVE-2016-0800', 5, 5.9, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N', '2016-03-01 00:00:00', 'CVE-2016-0800 desc', '2018-09-22 12:00:00'),
('CVE-2017-1000502', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-01-24 00:00:00', 'CVE-2017-1000502 desc', '2018-09-22 12:00:00'),
('CVE-2017-3001', 7, 8.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-03-14 00:00:00', 'CVE-2017-3001 desc', '2018-09-22 12:00:00'),
('CVE-2017-3004', 6, 7.8, 'CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', '2017-04-12 14:59:00', 'CVE-2017-3004 desc', '2018-09-22 12:00:00'),
('CVE-2017-3243', 4, 4.4, 'CVSS:3.0/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00', 'CVE-2017-3243 desc', '2018-09-22 12:00:00'),
('CVE-2017-3244', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2017-01-18 00:00:00', 'CVE-2017-3244 desc', '2018-09-22 12:00:00'),
('CVE-2017-5715', 5, 5.6, 'CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N', '2018-01-03 00:00:00', 'CVE-2017-5715 desc', '2018-09-22 12:00:00'),
('CVE-2017-5753', 5, 5.6, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00', 'CVE-2017-5753 desc', '2018-09-22 12:00:00'),
('CVE-2017-5754', 5, 5.5, 'CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N', '2018-01-03 00:00:00', 'CVE-2017-5754 desc', '2018-09-22 12:00:00'),
('CVE-2018-10908', 4, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H', '2018-08-08 00:00:00', 'CVE-2018-10908 desc', '2018-09-22 12:00:00'),
('CVE-2018-10931', 7, 9.8, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', '2018-08-09 00:00:00', 'CVE-2018-10931 desc', '2018-09-22 12:00:00'),
('CVE-2018-1102', 7, 9.9, 'CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H', '2018-04-27 00:00:00', 'CVE-2018-1102 desc', '2018-09-22 12:00:00'),
('CVE-2018-2814', 7, 7.5, 'CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H', '2018-04-17 00:00:00', 'CVE-2018-2814 desc', '2018-09-22 12:00:00'),
('CVE-2018-4117', 2, 6.5, 'CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N', '2018-07-24 00:00:00', 'CVE-2018-4117 desc', '2018-09-22 12:00:00');


INSERT INTO system_vulnerabilities (inventory_id, cve, first_reported, when_mitigated, status_id) VALUES
('INV-ID00-0000-0000', 'CVE-2014-0160', '2018-10-01 12:00:00', NULL, 0),
('INV-ID00-0000-0000', 'CVE-2016-0800', '2018-10-01 12:00:00', NULL, 0),
('INV-ID00-0000-1111', 'CVE-2014-0160', '2018-10-01 12:00:00', NULL, 1),
('INV-ID00-0000-1111', 'CVE-2016-0800', '2017-12-31 08:22:33', NULL, 1),
('INV-ID00-0000-1111', 'CVE-2017-1000502', '2018-10-01 12:00:00', '2018-10-04 14:13:12', 1),
('INV-ID00-0000-1111', 'CVE-2017-5715', '2018-06-22 18:15:13', NULL, 1),
('INV-ID00-0000-1111', 'CVE-2017-5753', '2018-09-01 12:00:00', NULL, 1),
('INV-ID00-0000-1111', 'CVE-2017-5754', '2018-09-01 12:00:00', NULL, 1),
('INV-ID00-0000-2222', 'CVE-2014-0160', '2018-09-01 12:00:00', '2018-09-22 12:00:00', 2),
('INV-ID00-0000-2222', 'CVE-2016-0800', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-1000502', '2018-04-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-5715', '2018-07-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-5753', '2018-02-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-5754', '2018-02-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2018-10908', '2018-02-01 12:00:00', '2018-09-01 12:00:00', 2),
('INV-ID00-0000-2222', 'CVE-2018-10931', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2018-1102', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2018-2814', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2018-4117', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-3001', '2018-09-01 12:00:00', NULL, 2),
('INV-ID00-0000-2222', 'CVE-2017-3244', '2018-04-01 12:00:00', '2018-09-01 12:00:00', 2),
('INV-ID00-0000-2222', 'CVE-2017-3243', '2018-04-01 12:00:00', NULL, 2),
('INV-ID00-0000-3333', 'CVE-2014-0160', '2018-03-01 12:00:00', NULL, 3),
('INV-ID00-0000-3333', 'CVE-2016-0800', '2018-03-01 12:00:00', '2018-09-01 12:00:00', 3),
('INV-ID00-0000-3333', 'CVE-2017-1000502', '2018-03-01 12:00:00', NULL, 3),
('INV-ID00-0000-3333', 'CVE-2017-5715', '2018-03-01 12:00:00', '2018-09-01 12:00:00', 3),
('INV-ID00-0000-3333', 'CVE-2017-5753', '2018-03-01 12:00:00', NULL, 3),
('INV-ID00-0000-3333', 'CVE-2017-5754', '2018-03-01 12:00:00', NULL, 3),
('INV-ID00-0000-4444', 'CVE-2014-0160', '2018-10-01 12:00:00', NULL, 4),
('INV-ID00-0000-4444', 'CVE-2016-0800', '2017-10-01 12:00:00', '2018-01-03 12:00:00', 4),
('INV-ID00-0000-4444', 'CVE-2017-1000502', '2017-10-01 12:00:00', '2018-01-03 12:00:00', 4),
('INV-ID00-0000-4444', 'CVE-2017-5715', '2017-10-01 12:00:00', NULL, 4),
('INV-ID00-0000-5555', 'CVE-2014-0160', '2018-10-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2016-0800', '2018-10-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2017-1000502', '2018-10-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2017-5715', '2018-08-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2017-5753', '2018-08-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2017-5754', '2018-08-03 12:00:00', NULL, 5),
('INV-ID00-0000-5555', 'CVE-2018-10908', '2017-10-03 12:00:00', NULL, 5),
('INV-ID00-0000-6666', 'CVE-2014-0160', '2018-10-01 12:00:00', '2018-10-03 12:00:00', 6),
('INV-ID00-0000-6666', 'CVE-2016-0800', '2018-10-01 12:00:00', '2018-10-03 12:00:00', 6);


INSERT INTO cve_affected_systems_cache (cve, rh_account, systems_affected, direct_systems_affected) VALUES
('CVE-2014-0160', '00000000', 5, 4),
('CVE-2016-0800', '00000000', 4, 4),
('CVE-2017-1000502', '00000000', 3, 3),
('CVE-2017-3001', '00000000', 1, 1),
('CVE-2017-3243', '00000000', 1, 1),
('CVE-2017-5715', '00000000', 4, 3),
('CVE-2017-5753', '00000000', 4, 4),
('CVE-2017-5754', '00000000', 4, 4),
('CVE-2018-10908', '00000000', 1, 1),
('CVE-2018-10931', '00000000', 1, 1),
('CVE-2018-1102', '00000000', 1, 1),
('CVE-2018-2814', '00000000', 1, 1),
('CVE-2018-4117', '00000000', 1, 1);


INSERT INTO cve_impact (id, name) VALUES
(0, 'NotSet'), (1, 'None'), (2, 'Low'), (3, 'Medium'), (4, 'Moderate'),
(5, 'Important'), (6, 'High'), (7, 'Critical');


INSERT INTO status (id, name) VALUES
(0, 'Not Reviewed'), (1, 'In-Review'), (2, 'On-Hold'), (3, 'Scheduled for Patch'), (4, 'Resolved'),
(5, 'No Action - Risk Accepted'), (6, 'Resolved via Mitigation (e.g. done without deploying a patch)');
